<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>움직이는 사진관 — 사진이 살아 움직입니다</title>
<meta name="description" content="소중한 가족 사진을 살아 움직이는 감동 영상으로. 환갑·칠순·결혼기념일 행사 상영용 프리미엄 인생 영상.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@300;400;600;700&family=Noto+Sans+KR:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.portone.io/v2/browser-sdk.js"></script>
<style>
:root {
  --gold:        #c9a96e;
  --gold-light:  #e8c98a;
  --gold-dim:    #c9a96e22;
  --bg:          #080808;
  --surface:     #0d0d0d;
  --card:        #111111;
  --border:      #1e1e1e;
  --border-mid:  #2a2a2a;
  --text:        #f0ebe3;
  --muted:       #7a7168;
  --muted-light: #a09488;
  --serif: 'Noto Serif KR', 'Georgia', serif;
  --sans:  'Noto Sans KR', -apple-system, sans-serif;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  font-family: var(--sans);
  background: var(--bg);
  color: var(--text);
  line-height: 1.7;
  -webkit-font-smoothing: antialiased;
}

/* ── 공통 ──────────────────────────────────────────── */
.serif { font-family: var(--serif); }
.gold  { color: var(--gold); }

.section-label {
  font-family: var(--sans);
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 20px;
  display: block;
}

.divider {
  width: 40px;
  height: 1px;
  background: var(--gold);
  margin: 20px auto;
}

/* ── Hero ──────────────────────────────────────────── */
.hero {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 80px 24px;
  position: relative;
  overflow: hidden;
}

.hero::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(ellipse 60% 50% at 50% 0%, #c9a96e08, transparent),
    radial-gradient(ellipse 40% 30% at 80% 80%, #c9a96e05, transparent);
  pointer-events: none;
}

.hero-eyebrow {
  font-family: var(--sans);
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 36px;
  display: flex;
  align-items: center;
  gap: 12px;
}
.hero-eyebrow::before,
.hero-eyebrow::after {
  content: '';
  width: 28px;
  height: 1px;
  background: var(--gold);
  opacity: .6;
}

.hero h1 {
  font-family: var(--serif);
  font-size: clamp(32px, 6vw, 60px);
  font-weight: 300;
  line-height: 1.3;
  letter-spacing: -0.5px;
  margin-bottom: 28px;
  color: var(--text);
}
.hero h1 em {
  font-style: normal;
  color: var(--gold);
}

.hero-sub {
  font-size: 15px;
  color: var(--muted-light);
  max-width: 440px;
  margin: 0 auto 52px;
  line-height: 1.9;
  font-weight: 300;
}

.cta-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
}

.cta-btn {
  background: var(--gold);
  color: #080808;
  border: none;
  cursor: pointer;
  padding: 16px 48px;
  font-family: var(--sans);
  font-size: 14px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  transition: background .2s, transform .2s;
}
.cta-btn:hover {
  background: var(--gold-light);
  transform: translateY(-1px);
}

.price-hint {
  font-size: 13px;
  color: var(--muted);
  letter-spacing: .3px;
}
.price-hint strong {
  color: var(--gold);
  font-weight: 500;
}

/* ── 특징 ──────────────────────────────────────────── */
.features {
  padding: 120px 24px;
  max-width: 960px;
  margin: 0 auto;
  text-align: center;
}

.features-title {
  font-family: var(--serif);
  font-size: clamp(24px, 3.5vw, 38px);
  font-weight: 300;
  margin-bottom: 72px;
  color: var(--text);
  line-height: 1.4;
}

.feature-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 0;
  border: 1px solid var(--border);
}

.feature-card {
  padding: 40px 28px;
  border-right: 1px solid var(--border);
  text-align: left;
  position: relative;
  transition: background .2s;
}
.feature-card:last-child { border-right: none; }
.feature-card:hover { background: #111111; }

.feature-num {
  font-family: var(--serif);
  font-size: 11px;
  color: var(--gold);
  letter-spacing: 2px;
  margin-bottom: 20px;
  display: block;
}

.feature-card h3 {
  font-family: var(--serif);
  font-size: 16px;
  font-weight: 400;
  margin-bottom: 12px;
  color: var(--text);
}

.feature-card p {
  font-size: 13px;
  color: var(--muted);
  line-height: 1.8;
  font-weight: 300;
}

/* ── 프로세스 ──────────────────────────────────────── */
.process {
  padding: 120px 24px;
  background: var(--surface);
  border-top: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
}

.process-inner {
  max-width: 640px;
  margin: 0 auto;
}

.process-title {
  font-family: var(--serif);
  font-size: clamp(22px, 3vw, 34px);
  font-weight: 300;
  text-align: center;
  margin-bottom: 64px;
  line-height: 1.4;
}

.steps {
  display: flex;
  flex-direction: column;
  gap: 0;
}

.step {
  display: flex;
  gap: 28px;
  padding: 28px 0;
  border-bottom: 1px solid var(--border);
  align-items: flex-start;
}
.step:last-child { border-bottom: none; }

.step-num {
  font-family: var(--serif);
  font-size: 11px;
  color: var(--gold);
  letter-spacing: 2px;
  flex-shrink: 0;
  padding-top: 3px;
  width: 36px;
}

.step-content h4 {
  font-family: var(--serif);
  font-size: 16px;
  font-weight: 400;
  margin-bottom: 6px;
  color: var(--text);
}

.step-content p {
  font-size: 13px;
  color: var(--muted);
  line-height: 1.8;
  font-weight: 300;
}

/* ── 주문 폼 ──────────────────────────────────────── */
.order-section {
  padding: 120px 24px;
  max-width: 520px;
  margin: 0 auto;
}

.order-card {
  border: 1px solid var(--border);
  padding: 48px 40px;
  background: var(--card);
}

.order-card-title {
  font-family: var(--serif);
  font-size: 26px;
  font-weight: 300;
  margin-bottom: 6px;
  color: var(--text);
}

.order-card-sub {
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 36px;
  font-weight: 300;
  line-height: 1.8;
}

.form-group { margin-bottom: 20px; }

.form-group label {
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--muted);
  margin-bottom: 8px;
  display: block;
}

.form-group input,
.form-group select {
  width: 100%;
  background: var(--bg);
  border: 1px solid var(--border-mid);
  color: var(--text);
  padding: 13px 16px;
  font-size: 14px;
  font-family: var(--sans);
  outline: none;
  transition: border-color .2s;
  border-radius: 0;
  appearance: none;
  -webkit-appearance: none;
}

.form-group input:focus,
.form-group select:focus { border-color: var(--gold); }
.form-group input::placeholder { color: #3a3530; }

.form-error { font-size: 12px; color: #c97070; margin-top: 6px; display: none; letter-spacing: .3px; }

.price-box {
  border: 1px solid var(--border-mid);
  padding: 20px 24px;
  margin: 32px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--surface);
}

.price-box .label {
  font-size: 13px;
  color: var(--muted-light);
}

.price-box .label-sub {
  font-size: 11px;
  color: var(--muted);
  margin-top: 3px;
  letter-spacing: .3px;
}

.price-box .amount {
  font-family: var(--serif);
  font-size: 22px;
  font-weight: 400;
  color: var(--gold);
}

.submit-btn {
  width: 100%;
  background: var(--gold);
  color: #080808;
  border: none;
  padding: 16px;
  font-family: var(--sans);
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  cursor: pointer;
  transition: background .2s;
}
.submit-btn:hover { background: var(--gold-light); }
.submit-btn:disabled { opacity: .45; cursor: not-allowed; }

.notice {
  font-size: 11px;
  color: var(--muted);
  text-align: center;
  margin-top: 16px;
  line-height: 2;
  letter-spacing: .3px;
}

/* ── 개발용 ──────────────────────────────────────── */
.dev-btn {
  width: 100%;
  background: transparent;
  color: #8a6f30;
  border: 1px dashed #3a2f18;
  padding: 11px;
  font-size: 12px;
  font-family: var(--sans);
  cursor: pointer;
  margin-top: 10px;
  transition: background .2s;
  letter-spacing: .5px;
}
.dev-btn:hover { background: #1a1508; }
.dev-btn:disabled { opacity: .4; cursor: not-allowed; }

.dev-banner {
  background: #0f0c04;
  border: 1px solid #3a2f18;
  padding: 8px 14px;
  font-size: 11px;
  color: #8a6f30;
  text-align: center;
  margin-bottom: 24px;
  letter-spacing: .5px;
}

/* ── 업로드 공통 ─────────────────────────────────── */
.upload-section {
  display: none;
  padding: 80px 24px;
  max-width: 520px;
  margin: 0 auto;
}

.upload-card {
  border: 1px solid var(--border);
  padding: 40px;
  background: var(--card);
}

.progress-bar {
  height: 1px;
  background: var(--border-mid);
  margin: 16px 0;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--gold);
  transition: width .4s;
  width: 0%;
}

.upload-drop {
  border: 1px dashed var(--border-mid);
  padding: 48px 24px;
  text-align: center;
  cursor: pointer;
  transition: border-color .2s, background .2s;
  margin-bottom: 20px;
}
.upload-drop:hover,
.upload-drop.drag-over {
  border-color: var(--gold);
  background: #c9a96e06;
}

#file-input { display: none; }

/* ── 완료 ──────────────────────────────────────── */
.done-section {
  display: none;
  padding: 120px 24px;
  max-width: 480px;
  margin: 0 auto;
  text-align: center;
}

.done-mark {
  width: 56px;
  height: 56px;
  border: 1px solid var(--gold);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 32px;
  color: var(--gold);
  font-size: 20px;
}

.done-section h2 {
  font-family: var(--serif);
  font-size: 26px;
  font-weight: 300;
  margin-bottom: 16px;
}

.done-section p {
  color: var(--muted-light);
  font-size: 14px;
  line-height: 1.9;
  font-weight: 300;
}

.order-number {
  border: 1px solid var(--border-mid);
  padding: 14px 20px;
  margin: 24px 0;
  font-family: var(--serif);
  font-size: 15px;
  color: var(--gold);
  letter-spacing: 1px;
}

/* ── 푸터 ──────────────────────────────────────── */
footer {
  border-top: 1px solid var(--border);
  padding: 36px 24px;
  text-align: center;
  font-size: 12px;
  color: var(--muted);
  letter-spacing: .5px;
  line-height: 2;
}

/* ── 이어하기 모달 ─────────────────────────────── */
#resume-modal {
  display: none;
  position: fixed;
  inset: 0;
  background: #000000e0;
  z-index: 9999;
  align-items: center;
  justify-content: center;
  padding: 24px;
}

.resume-inner {
  background: var(--card);
  border: 1px solid var(--border-mid);
  padding: 48px 40px;
  max-width: 400px;
  width: 100%;
  text-align: center;
}

.resume-inner h3 {
  font-family: var(--serif);
  font-size: 20px;
  font-weight: 300;
  margin-bottom: 12px;
}

.resume-inner p {
  font-size: 13px;
  color: var(--muted-light);
  line-height: 1.9;
  margin-bottom: 32px;
  font-weight: 300;
}

.resume-btns {
  display: flex;
  gap: 10px;
}

.btn-resume-yes {
  flex: 2;
  background: var(--gold);
  color: #080808;
  border: none;
  padding: 14px;
  font-family: var(--sans);
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 1px;
  cursor: pointer;
  transition: background .2s;
}
.btn-resume-yes:hover { background: var(--gold-light); }

.btn-resume-no {
  flex: 1;
  background: transparent;
  color: var(--muted);
  border: 1px solid var(--border-mid);
  padding: 14px;
  font-family: var(--sans);
  font-size: 12px;
  letter-spacing: .5px;
  cursor: pointer;
  transition: border-color .2s, color .2s;
}
.btn-resume-no:hover { border-color: var(--muted); color: var(--text); }

/* ── 가이드 섹션 ──────────────────────────────── */
.guide-sequence {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0;
  margin: 32px 0;
  flex-wrap: wrap;
}

.guide-seq-item {
  text-align: center;
  padding: 0 16px;
}

.guide-seq-item .era {
  font-family: var(--serif);
  font-size: 13px;
  color: var(--text);
  display: block;
  margin-bottom: 4px;
}

.guide-seq-item .period {
  font-size: 11px;
  color: var(--muted);
  letter-spacing: .5px;
}

.guide-seq-arrow {
  color: var(--gold);
  font-size: 14px;
  opacity: .5;
}

.guide-tip {
  border-left: 2px solid var(--gold);
  padding: 16px 20px;
  margin: 28px 0;
  background: #c9a96e05;
}

.guide-tip p {
  font-size: 13px;
  color: var(--muted-light);
  line-height: 1.9;
  font-weight: 300;
}

/* ── 스텝 업로드 ─────────────────────────────── */
.step-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 24px;
  padding-bottom: 20px;
  border-bottom: 1px solid var(--border);
}

.step-order-num {
  font-size: 12px;
  color: var(--muted);
  letter-spacing: .5px;
}

.step-counter {
  font-family: var(--serif);
  font-size: 13px;
  color: var(--gold);
  letter-spacing: 2px;
}

.step-title-text {
  font-family: var(--serif);
  font-size: 20px;
  font-weight: 300;
  margin-bottom: 4px;
  color: var(--text);
}

.step-subtitle {
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 20px;
  font-weight: 300;
  letter-spacing: .3px;
}

.drop-icon {
  width: 40px;
  height: 40px;
  border: 1px solid var(--border-mid);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 16px;
  color: var(--gold);
  font-size: 16px;
}

.drop-main-text {
  font-size: 13px;
  color: var(--muted-light);
  margin-bottom: 4px;
}

.drop-sub-text {
  font-size: 11px;
  color: var(--muted);
  letter-spacing: .3px;
}

.caption-label {
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--muted);
  display: block;
  margin-bottom: 8px;
}

.step-nav {
  display: flex;
  gap: 10px;
  margin-top: 24px;
}

.btn-prev {
  flex: 1;
  background: transparent;
  color: var(--muted);
  border: 1px solid var(--border-mid);
  padding: 13px;
  font-family: var(--sans);
  font-size: 12px;
  letter-spacing: 1px;
  cursor: pointer;
  transition: border-color .2s, color .2s;
}
.btn-prev:hover { border-color: var(--muted); color: var(--text); }

.btn-next {
  flex: 2;
  background: var(--gold);
  color: #080808;
  border: none;
  padding: 13px;
  font-family: var(--sans);
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  cursor: pointer;
  transition: background .2s;
}
.btn-next:disabled { opacity: .35; cursor: not-allowed; }
.btn-next:not(:disabled):hover { background: var(--gold-light); }

.btn-submit-all {
  display: none;
  width: 100%;
  margin-top: 12px;
  background: var(--gold);
  color: #080808;
  border: none;
  padding: 15px;
  font-family: var(--sans);
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  cursor: pointer;
  transition: background .2s;
}
.btn-submit-all:hover { background: var(--gold-light); }

.progress-label {
  font-size: 11px;
  color: var(--muted);
  text-align: center;
  letter-spacing: .5px;
  margin-bottom: 24px;
}

/* ── 반응형 ──────────────────────────────────── */
@media (max-width: 600px) {
  .feature-grid { grid-template-columns: 1fr 1fr; }
  .feature-card { border-bottom: 1px solid var(--border); }
  .feature-card:nth-child(odd) { border-right: 1px solid var(--border); }
  .feature-card:nth-child(even) { border-right: none; }
  .order-card, .upload-card { padding: 28px 20px; }
  .resume-inner { padding: 36px 24px; }
  .guide-sequence { gap: 0; }
  .guide-seq-item { padding: 0 8px; }
}

@media (max-width: 400px) {
  .feature-grid { grid-template-columns: 1fr; }
  .feature-card { border-right: none; }
}
</style>
</head>
<body>

<!-- ── Hero ── -->
<section class="hero">
  <div class="hero-eyebrow">움직이는 사진관</div>
  <h1>부모님의 세월이<br><em>살아 움직입니다</em></h1>
  <p class="hero-sub">
    소중한 가족 사진을 자연스럽게 움직이는 감동 영상으로.<br>
    환갑·칠순·결혼기념일 행사에서 바로 상영하세요.
  </p>
  <div class="cta-wrap">
    <button class="cta-btn" onclick="scrollToOrder()">지금 주문하기</button>
    <p class="price-hint">단 <strong>29,900원</strong> · 24시간 내 제작 · 1080p 16:9</p>
  </div>
</section>

<!-- ── 릴스 미리보기 ── -->
<section style="padding: 80px 24px 0; display:flex; flex-direction:column; align-items:center; text-align:center;">
  <span class="section-label">Preview</span>
  <h2 style="font-family:var(--serif);font-size:clamp(20px,3vw,30px);font-weight:300;margin-bottom:8px;color:var(--text)">이런 영상이 가능합니다</h2>
  <p style="font-size:13px;color:var(--muted);font-weight:300;margin-bottom:36px">부모님께 평생 잊지 못할 감동을 드리세요</p>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;max-width:680px;width:100%">
    <blockquote class="instagram-media" data-instgrm-permalink="https://www.instagram.com/reel/DRftS3lkVGk/?utm_source=ig_embed&amp;utm_campaign=loading" data-instgrm-version="14" style="background:#FFF;border:0;border-radius:3px;box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15);margin:0;padding:0;width:100%;min-width:unset"></blockquote>
    <blockquote class="instagram-media" data-instgrm-permalink="https://www.instagram.com/reel/DPbgSLTCHy3/?utm_source=ig_embed&amp;utm_campaign=loading" data-instgrm-version="14" style="background:#FFF;border:0;border-radius:3px;box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15);margin:0;padding:0;width:100%;min-width:unset"></blockquote>
  </div>
  <script async src="//www.instagram.com/embed.js"></script>
</section>

<!-- ── 특징 ── -->
<section class="features">
  <span class="section-label">Why Different</span>
  <h2 class="features-title">단순한 슬라이드쇼가 아닙니다</h2>
  <div class="feature-grid">
    <div class="feature-card">
      <span class="feature-num">01</span>
      <h3>살아 움직이는 사진</h3>
      <p>AI가 사진 속 인물의 표정과 배경을 분석해 자연스러운 움직임을 만들어냅니다.</p>
    </div>
    <div class="feature-card">
      <span class="feature-num">02</span>
      <h3>감성 배경 음악</h3>
      <p>영상 분위기에 맞는 감성적인 음악이 함께 흘러 감동을 더해줍니다.</p>
    </div>
    <div class="feature-card">
      <span class="feature-num">03</span>
      <h3>행사 상영 최적화</h3>
      <p>1920×1080 풀HD 가로형 제작. 빔프로젝터·TV 어디서든 바로 상영 가능합니다.</p>
    </div>
    <div class="feature-card">
      <span class="feature-num">04</span>
      <h3>24시간 내 완성</h3>
      <p>주문 후 24시간 이내에 완성 영상 다운로드 링크를 문자로 보내드립니다.</p>
    </div>
  </div>
</section>

<!-- ── 프로세스 ── -->
<section class="process">
  <div class="process-inner">
    <span class="section-label" style="text-align:center;display:block">How It Works</span>
    <h2 class="process-title">사진관처럼 맡기세요</h2>
    <div class="steps">
      <div class="step">
        <span class="step-num">01</span>
        <div class="step-content">
          <h4>주문 &amp; 결제 — 1분</h4>
          <p>이름, 연락처 입력 후 29,900원 결제. KG이니시스로 안전하게 처리됩니다.</p>
        </div>
      </div>
      <div class="step">
        <span class="step-num">02</span>
        <div class="step-content">
          <h4>사진 업로드 — 5분</h4>
          <p>가족 사진 10~15장을 나이 순서대로 업로드합니다. 각 사진에 짧은 제목을 입력하면 영상에 자막으로 표시됩니다.</p>
        </div>
      </div>
      <div class="step">
        <span class="step-num">03</span>
        <div class="step-content">
          <h4>AI 제작 — 24시간 이내</h4>
          <p>AI가 각 사진에 자연스러운 움직임을 만들고 음악과 함께 편집합니다.</p>
        </div>
      </div>
      <div class="step">
        <span class="step-num">04</span>
        <div class="step-content">
          <h4>문자로 전달</h4>
          <p>완성되면 등록하신 번호로 다운로드 링크를 문자 발송합니다. 72시간 내 다운로드 가능합니다.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ── 주문 폼 ── -->
<section class="order-section" id="order-section">
  <span class="section-label" style="text-align:center;display:block">Order</span>
  <div class="order-card">
    <h2 class="order-card-title">사진 맡기기</h2>
    <p class="order-card-sub">결제 후 사진을 업로드하시면<br>24시간 내 완성 영상을 보내드립니다.</p>

    <div class="form-group">
      <label>이름</label>
      <input type="text" id="customerName" placeholder="홍길동" maxlength="20">
      <div class="form-error" id="err-name"></div>
    </div>
    <div class="form-group">
      <label>연락처 <span style="font-size:10px;letter-spacing:.3px;text-transform:none;font-weight:300">완성 알림 수신</span></label>
      <input type="tel" id="customerPhone" placeholder="01012345678" maxlength="11">
      <div class="form-error" id="err-phone"></div>
    </div>
    <div class="form-group">
      <label>이메일 <span style="font-size:10px;text-transform:none;font-weight:300;letter-spacing:.3px">선택</span></label>
      <input type="email" id="customerEmail" placeholder="example@email.com">
    </div>
    <div class="form-group">
      <label>사진 수량</label>
      <select id="photoCount">
        <option value="10">10장</option>
        <option value="11">11장</option>
        <option value="12" selected>12장 (추천)</option>
        <option value="13">13장</option>
        <option value="14">14장</option>
        <option value="15">15장</option>
      </select>
    </div>

    <div class="price-box">
      <div>
    <div class="label">프리미엄 인생 영상 1편</div>
        <div class="label-sub">16:9 · 1080p · 60~90초 · 24시간 내 제작</div>
      </div>
      <div class="amount">29,900원</div>
    </div>

    <button class="submit-btn" id="pay-btn" onclick="startPayment()">
      결제하고 사진 업로드하기
    </button>

    <button class="dev-btn" id="dev-skip-pay-btn" onclick="devSkipPayment()" style="display:none">
      [DEV] 결제 스킵
    </button>

    <p class="notice">
      KG이니시스 보안 결제 · 개인정보는 영상 제작에만 사용됩니다<br>
      결제 후 취소는 영상 제작 시작 전까지 가능합니다
    </p>
  </div>
</section>

<!-- ── 이어하기 모달 ── -->
<div id="resume-modal">
  <div class="resume-inner">
    <span class="section-label">미완료 주문</span>
  <h3>이전 주문이 있습니다</h3>
    <p>
      <strong id="resume-name" style="color:var(--gold);font-weight:400"></strong>님의 주문
      <strong id="resume-order-id" style="color:var(--gold);font-weight:400"></strong>이<br>
      사진 업로드를 기다리고 있습니다.<br>이어서 진행하시겠습니까?
    </p>
    <div class="resume-btns">
      <button class="btn-resume-yes" onclick="resumeExistingOrder()">이어서 업로드</button>
      <button class="btn-resume-no" onclick="closeResumeModal()">새로 주문</button>
    </div>
  </div>
</div>

<!-- ── 업로드 가이드 ── -->
<section class="upload-section" id="guide-section">
  <div class="upload-card">
    <div class="dev-banner" id="dev-upload-banner" style="display:none">[DEV] 실제 S3 업로드 모드</div>

    <span class="section-label">Upload Guide</span>
    <h2 style="font-family:var(--serif);font-size:22px;font-weight:300;margin-bottom:8px">사진 업로드 안내</h2>
    <p style="font-size:13px;color:var(--muted-light);font-weight:300;line-height:1.9;margin-bottom:4px">
      사진은 <strong style="color:var(--gold);font-weight:400">어린 시절부터 현재 순서</strong>로 업로드해 주세요.<br>
      시간의 흐름이 담길수록 더 감동적인 영상이 완성됩니다.
    </p>

    <div class="divider" style="margin:28px 0"></div>

    <div class="guide-sequence">
      <div class="guide-seq-item">
        <span class="era">유년기</span>
        <span class="period">돌·유치원</span>
      </div>
      <span class="guide-seq-arrow">›</span>
      <div class="guide-seq-item">
        <span class="era">학창 시절</span>
        <span class="period">초·중·고</span>
      </div>
      <span class="guide-seq-arrow">›</span>
      <div class="guide-seq-item">
        <span class="era">청년기</span>
        <span class="period">졸업·취업</span>
      </div>
      <span class="guide-seq-arrow">›</span>
      <div class="guide-seq-item">
        <span class="era">현재</span>
        <span class="period">가족·일상</span>
      </div>
    </div>

    <div class="guide-tip">
      <p>
        각 사진마다 짧은 제목을 입력하시면 영상에 자막으로 표시됩니다.<br>
        얼굴이 선명하게 보이는 사진일수록 결과물이 좋습니다.<br>
        총 <span id="guide-total" style="color:var(--gold)"></span>장을 시간순으로 준비해 주세요.
      </p>
    </div>

    <button class="submit-btn" onclick="startStepUpload()" style="margin-bottom:10px">
      업로드 시작하기
    </button>
    <button class="dev-btn" id="dev-skip-upload-btn" onclick="devSkipUpload()" style="display:none">
      [DEV] 업로드 스킵
    </button>
  </div>
</section>

<!-- ── 스텝 업로드 ── -->
<section class="upload-section" id="upload-section">
  <div class="upload-card">
    <div class="dev-banner" id="dev-step-banner" style="display:none">[DEV] 실제 S3 업로드 모드</div>

    <div class="step-header">
      <div class="step-order-num">주문번호 <span id="order-num-display" style="color:var(--gold)"></span></div>
      <div class="step-counter" id="step-label">1 / 12</div>
    </div>

    <div class="progress-bar">
      <div class="progress-fill" id="upload-progress"></div>
    </div>
    <div class="progress-label" id="progress-text">0 / 0 완료</div>

    <h2 class="step-title-text" id="step-title">첫 번째 사진</h2>
    <p class="step-subtitle">어린 시절 사진부터 순서대로 업로드해 주세요</p>

    <div class="upload-drop" id="drop-zone" onclick="document.getElementById('file-input').click()">
      <div id="drop-preview">
        <div class="drop-icon">+</div>
        <p class="drop-main-text">클릭하거나 사진을 드래그하세요</p>
        <p class="drop-sub-text">JPG, PNG · 20MB 이하</p>
      </div>
      <p id="drop-text" style="font-size:12px;color:var(--muted);margin-top:8px"></p>
    </div>
    <input type="file" id="file-input" accept="image/jpeg,image/png,image/jpg">

    <div style="margin-top:20px">
      <span class="caption-label">사진 제목 <span style="font-size:10px;text-transform:none;letter-spacing:.3px;font-weight:300;color:var(--muted)">선택 · 최대 10자 · 영상 자막으로 표시</span></span>
      <input type="text" id="step-caption" maxlength="10" placeholder="예: 1985년 돌잔치"
             style="width:100%;background:var(--bg);border:1px solid var(--border-mid);color:var(--text);
                    padding:13px 16px;font-size:14px;font-family:var(--sans);outline:none;
                    transition:border-color .2s"
             onfocus="this.style.borderColor='var(--gold)'"
             onblur="this.style.borderColor='var(--border-mid)'"
             oninput="document.getElementById('caption-count').textContent=this.value.length">
      <div style="text-align:right;font-size:11px;color:var(--muted);margin-top:6px;letter-spacing:.3px">
        <span id="caption-count">0</span> / 10
      </div>
    </div>

    <div class="step-nav">
      <button onclick="prevStep()" id="prev-btn" class="btn-prev">← 이전</button>
      <button onclick="nextStep()" id="next-btn" class="btn-next" disabled>다음 →</button>
    </div>

    <button onclick="submitAllPhotos()" id="submit-all-btn" class="btn-submit-all">
      업로드 완료 — 영상 제작 시작
    </button>
  </div>
</section>

<!-- ── 완료 ── -->
<section class="done-section" id="done-section">
  <div class="done-mark">✓</div>
  <span class="section-label">Complete</span>
  <h2>영상이 완성되었습니다</h2>
  <div class="order-number" id="done-order-num"></div>
  <p>
    24시간 이내에 완성 영상 다운로드 링크를<br>
    등록하신 연락처로 카카오 알림톡으로 보내드립니다.<br><br>
    소중한 순간을 정성껏 담아드리겠습니다.
  </p>
</section>

<footer>
  <p>움직이는 사진관 &nbsp;·&nbsp; 문의: 카카오톡 채널 @움직이는사진관</p>
  <p style="margin-top:6px">ⓒ 2025 움직이는 사진관. All rights reserved.</p>
</footer>

<script>
let PORTONE_STORE_ID = '';
let PORTONE_CHANNEL_KEY = '';
let IS_DEV = false;
let currentOrderId = null;
let presignedUrls = [];
let selectedFiles = [];

function scrollToOrder() {
  document.getElementById('order-section').scrollIntoView({ behavior: 'smooth' });
}

// ── DEV 모드 감지 — localhost이면 바로 노출 ──────────────────────────
function detectDevMode() {
  IS_DEV = location.hostname === 'localhost' || location.hostname === '127.0.0.1';
  if (IS_DEV) {
    document.getElementById('dev-skip-pay-btn').style.display = 'block';
  }
}

// ── 주문 공통 생성 ────────────────────────────────────────────────────
async function createOrder() {
  const name       = document.getElementById('customerName').value.trim();
  const phone      = document.getElementById('customerPhone').value.trim();
  const email      = document.getElementById('customerEmail').value.trim();
  const photoCount = parseInt(document.getElementById('photoCount').value);

  let valid = true;
  if (!name) { showError('err-name', '이름을 입력해주세요'); valid = false; }
  else hideError('err-name');
  if (!/^01[016789]\d{7,8}$/.test(phone)) {
    showError('err-phone', '올바른 휴대폰 번호를 입력해주세요 (예: 01012345678)');
    valid = false;
  } else hideError('err-phone');
  if (!valid) throw new Error('VALIDATION');

  const resp = await fetch('/api/orders', {
    method:  'POST',
    headers: { 'Content-Type': 'application/json' },
    body:    JSON.stringify({ customerName: name, customerPhone: phone,
                              customerEmail: email || null, photoCount })
  });
  if (!resp.ok) {
    const err = await resp.json().catch(() => ({}));
    throw new Error(err.message || '주문 생성 실패');
  }
  return resp.json();
}

// ── 결제 시작 (실제) ──────────────────────────────────────────────────
async function startPayment() {
  const btn = document.getElementById('pay-btn');
  btn.disabled = true;
  btn.textContent = '처리 중...';

  try {
    const orderData = await createOrder();

    // 이어하기: 미완료 주문 감지
    if (orderData.isExistingOrder) {
      showResumeModal(orderData);
      btn.disabled = false;
      btn.textContent = '결제하고 사진 업로드하기';
      return;
    }

    currentOrderId = orderData.orderId;
    presignedUrls  = orderData.presignedUrls;

    const response = await PortOne.requestPayment({
      storeId:     PORTONE_STORE_ID,
      channelKey:  PORTONE_CHANNEL_KEY,
      paymentId:   String(orderData.orderId),
      orderName:   '프리미엄 기념일 인생 영상',
      totalAmount: orderData.amount,
      currency:    'CURRENCY_KRW',
      payMethod:   'CARD',
      customer: {
        fullName:    document.getElementById('customerName').value.trim(),
        phoneNumber: document.getElementById('customerPhone').value.trim(),
        email:       document.getElementById('customerEmail').value.trim() || 'order@anniversary-video.com',
      },
      redirectUrl: window.location.origin + '/payment/success',
    });
    if (response.code) throw { code: response.code, message: response.message };
  } catch (e) {
    if (e.message !== 'VALIDATION' && e.code !== 'USER_CANCEL') alert('오류: ' + e.message);
    btn.disabled = false;
    btn.textContent = '결제하고 사진 업로드하기';
  }
}

// ── [DEV] 결제 스킵 ───────────────────────────────────────────────────
async function devSkipPayment() {
  const skipBtn = document.getElementById('dev-skip-pay-btn');
  const payBtn  = document.getElementById('pay-btn');
  skipBtn.disabled = true;
  skipBtn.textContent = '처리 중...';
  payBtn.disabled = true;
  try {
    const orderData = await createOrder();
    currentOrderId = orderData.orderId;

    const res = await fetch(`/api/dev/orders/${currentOrderId}/skip-payment`, { method: 'POST' });
    if (!res.ok) throw new Error('결제 스킵 실패');
    const data = await res.json();

    presignedUrls = data.presignedUrls || [];
    showUploadSection(currentOrderId, IS_DEV);
  } catch(e) {
    if (e.message !== 'VALIDATION') alert('DEV 오류: ' + e.message);
    skipBtn.disabled = false;
    skipBtn.textContent = '[DEV] 결제 스킵';
    payBtn.disabled = false;
  }
}

// ── [DEV] 업로드 스킵 ─────────────────────────────────────────────────
async function devSkipUpload() {
  const btn = document.getElementById('dev-skip-upload-btn');
  btn.disabled = true;
  btn.textContent = '처리 중...';

  try {
    const resp = await fetch(`/api/dev/orders/${currentOrderId}/skip-upload`, {
      method: 'POST'
    });
    if (!resp.ok) {
      const err = await resp.json().catch(() => ({}));
      throw new Error(err.message || '업로드 스킵 실패');
    }
    const data = await resp.json();
    console.log('[DEV] 업로드 스킵:', data);
    showDone();
  } catch (e) {
    alert('오류: ' + e.message);
    btn.disabled = false;
    btn.textContent = '[DEV] 업로드 스킵';
  }
}

// ── 결제 성공 리다이렉트 처리 ──────────────────────────────────────────
async function handlePaymentSuccess() {
  const params    = new URLSearchParams(window.location.search);
  const paymentId = params.get('paymentId');
  const orderId   = params.get('orderId') || params.get('payment_id');
  if (!paymentId && !orderId) return;

  hideMainSections();
  const loadingDiv = showLoading('결제 처리 중...');

  const resolvedPaymentId = paymentId || orderId;
  const resolvedOrderId   = orderId   || paymentId;

  try {
    const confirmResp = await fetch('/api/payments/confirm', {
      method:  'POST',
      headers: { 'Content-Type': 'application/json' },
      body:    JSON.stringify({ paymentId: resolvedPaymentId, orderId: resolvedOrderId, amount: 29900 })
    });
    if (!confirmResp.ok) {
      const err = await confirmResp.json().catch(() => ({}));
      throw new Error(err.message || '결제 승인 실패');
    }

    currentOrderId = parseInt(orderId);
    const urlResp  = await fetch('/api/orders/' + orderId + '/upload-urls');
    if (!urlResp.ok) throw new Error('업로드 URL 발급 실패');
    const urlData  = await urlResp.json();
    presignedUrls  = urlData.presignedUrls || [];

    loadingDiv.remove();
    showUploadSection(orderId, false);

  } catch (e) {
    loadingDiv.innerHTML = `
      <div style="font-size:36px;color:var(--gold);margin-bottom:20px">—</div>
      <div style="font-family:var(--serif);font-size:20px;font-weight:300;margin-bottom:12px">결제 처리 오류</div>
      <div style="font-size:13px;color:var(--muted);margin-bottom:8px">${e.message}</div>
      <div style="font-size:12px;color:var(--muted);margin-bottom:28px">주문번호: #${orderId} &nbsp;·&nbsp; 문의: 카카오톡 @기념일영상</div>
      <a href="/" style="padding:12px 32px;background:var(--gold);color:#080808;text-decoration:none;font-size:12px;font-weight:600;letter-spacing:1px">처음으로 돌아가기</a>`;
  }
}

// ── 업로드 가이드 화면 ────────────────────────────────────────────────
let stepData    = [];
let currentStep = 0;

function showUploadSection(orderId, devMode) {
  hideMainSections();
  const total = presignedUrls.length || 10;

  document.getElementById('guide-section').style.display = 'block';
  document.getElementById('guide-total').textContent = total;
  if (devMode) {
    document.getElementById('dev-upload-banner').style.display = 'block';
    document.getElementById('dev-skip-upload-btn').style.display = 'block';
  }
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function startStepUpload() {
  document.getElementById('guide-section').style.display  = 'none';
  document.getElementById('upload-section').style.display = 'block';

  stepData    = [];
  currentStep = 0;
  renderStep();

  const drop = document.getElementById('drop-zone');
  drop.addEventListener('dragover', e => { e.preventDefault(); drop.classList.add('drag-over'); });
  drop.addEventListener('dragleave', () => drop.classList.remove('drag-over'));
  drop.addEventListener('drop', e => {
    e.preventDefault(); drop.classList.remove('drag-over');
    const f = e.dataTransfer.files[0];
    if (f) handleStepFile(f);
  });
  document.getElementById('file-input').addEventListener('change', e => {
    const f = e.target.files[0];
    if (f) handleStepFile(f);
    e.target.value = '';
  });

  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function renderStep() {
  const total   = presignedUrls.length || 10;
  const stepNum = currentStep + 1;
  const isLast  = (stepNum === total);
  const ordinals = ['첫','두','세','네','다섯','여섯','일곱','여덟','아홉','열','열한','열두','열세','열네','열다섯'];

  document.getElementById('step-label').textContent = `${stepNum} / ${total}`;
  document.getElementById('step-title').textContent  = `${ordinals[currentStep] || stepNum}번째 사진`;
  document.getElementById('order-num-display').textContent = '#' + currentOrderId;

  const pct = Math.round((currentStep / total) * 100);
  document.getElementById('upload-progress').style.width = pct + '%';
  document.getElementById('progress-text').textContent   = `${currentStep} / ${total} 완료`;

  const saved = stepData[currentStep];
  if (saved && saved.file) {
    showPreview(saved.file);
    document.getElementById('next-btn').disabled = false;
  } else {
    document.getElementById('drop-preview').innerHTML = `
      <div class="drop-icon">+</div>
      <p class="drop-main-text">클릭하거나 사진을 드래그하세요</p>
      <p class="drop-sub-text">JPG, PNG · 20MB 이하</p>`;
    document.getElementById('drop-text').textContent = '';
    document.getElementById('next-btn').disabled = true;
  }
  document.getElementById('step-caption').value = (saved && saved.caption) || '';
  document.getElementById('caption-count').textContent = document.getElementById('step-caption').value.length;

  document.getElementById('prev-btn').style.visibility = (currentStep === 0) ? 'hidden' : 'visible';

  const nextBtn   = document.getElementById('next-btn');
  const submitBtn = document.getElementById('submit-all-btn');
  if (isLast) {
    nextBtn.style.display   = 'none';
    submitBtn.style.display = (saved && saved.file) ? 'block' : 'none';
  } else {
    nextBtn.style.display   = '';
    submitBtn.style.display = 'none';
  }
}

function handleStepFile(file) {
  if (!file.type.startsWith('image/')) return;
  if (!stepData[currentStep]) stepData[currentStep] = {};
  stepData[currentStep].file = file;
  showPreview(file);
  document.getElementById('next-btn').disabled = false;
  const total = presignedUrls.length || 10;
  if (currentStep + 1 === total) {
    document.getElementById('submit-all-btn').style.display = 'block';
  }
}

function showPreview(file) {
  const reader = new FileReader();
  reader.onload = e => {
    const prev = document.getElementById('drop-preview');
    prev.innerHTML = `<img src="${e.target.result}" style="width:100%;max-height:220px;object-fit:cover;">`;
    document.getElementById('drop-text').textContent = file.name;
  };
  reader.readAsDataURL(file);
}

function prevStep() {
  if (currentStep === 0) return;
  if (!stepData[currentStep]) stepData[currentStep] = {};
  stepData[currentStep].caption = document.getElementById('step-caption').value;
  currentStep--;
  renderStep();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function nextStep() {
  const total = presignedUrls.length || 10;
  if (currentStep >= total - 1) return;
  if (!stepData[currentStep] || !stepData[currentStep].file) {
    alert('사진을 먼저 선택해주세요.');
    return;
  }
  if (!stepData[currentStep]) stepData[currentStep] = {};
  stepData[currentStep].caption = document.getElementById('step-caption').value.trim();
  currentStep++;
  renderStep();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ── 전체 S3 업로드 + 완료 신고 ────────────────────────────────────────
async function submitAllPhotos() {
  const total = presignedUrls.length || 10;
  if (!stepData[currentStep]) stepData[currentStep] = {};
  stepData[currentStep].caption = document.getElementById('step-caption').value.trim();

  for (let i = 0; i < total; i++) {
    if (!stepData[i] || !stepData[i].file) {
      alert(`${i+1}번째 사진이 없습니다. 이전 버튼으로 돌아가서 추가해주세요.`);
      return;
    }
  }

  const btn = document.getElementById('submit-all-btn');
  btn.disabled = true;
  btn.textContent = '업로드 중...';

  const resultPhotos = [];

  for (let i = 0; i < total; i++) {
    const { file, caption } = stepData[i];
    const urlInfo = presignedUrls[i];

    document.getElementById('upload-progress').style.width = Math.round((i / total) * 100) + '%';
    document.getElementById('progress-text').textContent   = `${i} / ${total} 완료`;
    document.getElementById('step-label').textContent      = `${i+1} / ${total} 업로드 중`;

    try {
      const resp = await fetch(urlInfo.uploadUrl, {
        method: 'PUT',
        body:   file
      });
      if (!resp.ok) throw new Error(`${i+1}번째 사진 업로드 실패 (${resp.status})`);
      resultPhotos.push({ s3Key: urlInfo.s3Key, caption: caption || '' });
    } catch (err) {
      alert(err.message);
      btn.disabled = false;
      btn.textContent = '업로드 완료 — 영상 제작 시작';
      return;
    }
  }

  document.getElementById('upload-progress').style.width = '100%';
  document.getElementById('progress-text').textContent   = `${total} / ${total} 완료`;

  try {
    await fetch('/api/orders/' + currentOrderId + '/upload-complete', {
      method:  'POST',
      headers: { 'Content-Type': 'application/json' },
      body:    JSON.stringify({ photos: resultPhotos })
    });
  } catch (e) { console.error('upload-complete 오류:', e); }

  setTimeout(() => showDone(), 600);
}

function setFileStatus(i, cls, text) {
  const el = document.getElementById('file-status-' + i);
  if (el) { el.className = 'file-status ' + cls; el.textContent = text; }
}

function showDone() {
  document.getElementById('guide-section').style.display  = 'none';
  document.getElementById('upload-section').style.display = 'none';
  document.getElementById('done-section').style.display   = 'block';
  document.getElementById('done-order-num').textContent   = '주문번호 #' + currentOrderId;
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ── SMS resume ────────────────────────────────────────────────────────
async function handleResume(orderId) {
  hideMainSections();
  const loadingDiv = showLoading('주문 정보 확인 중...');
  try {
    const statusResp = await fetch('/api/orders/' + orderId + '/status');
    if (!statusResp.ok) throw new Error('주문을 찾을 수 없습니다.');
    const statusData = await statusResp.json();

    if (statusData.status === 'PROCESSING' || statusData.status === 'COMPLETED') {
      loadingDiv.innerHTML = '<div style="font-family:var(--serif);font-size:22px;font-weight:300;margin-bottom:12px">영상 제작 중입니다</div>' +
        '<div style="font-size:13px;color:var(--muted)">24시간 이내 완성 후 문자로 안내드립니다.</div>';
      return;
    }
    if (statusData.status !== 'PAID') {
      loadingDiv.innerHTML = '<div style="font-size:13px;color:var(--muted)">업로드할 수 없는 주문 상태입니다 (' + statusData.status + ')</div>';
      return;
    }

    const urlResp  = await fetch('/api/orders/' + orderId + '/upload-urls');
    if (!urlResp.ok) throw new Error('업로드 URL 발급 실패');
    presignedUrls  = (await urlResp.json()).presignedUrls || [];
    currentOrderId = parseInt(orderId);
    loadingDiv.remove();
    showUploadSection(orderId, false);
  } catch (e) {
    loadingDiv.innerHTML = '<div style="font-size:13px;color:var(--muted);margin-bottom:24px">' + e.message + '</div>' +
      '<a href="/" style="padding:12px 32px;background:var(--gold);color:#080808;text-decoration:none;font-size:12px;font-weight:600;letter-spacing:1px">처음으로</a>';
  }
}

// ── 유틸 ──────────────────────────────────────────────────────────────
function hideMainSections() {
  document.querySelector('.hero')          && (document.querySelector('.hero').style.display          = 'none');
  document.querySelector('.features')      && (document.querySelector('.features').style.display      = 'none');
  document.querySelector('.process')       && (document.querySelector('.process').style.display       = 'none');
  document.getElementById('order-section') && (document.getElementById('order-section').style.display = 'none');
}

function showLoading(msg) {
  const div = document.createElement('div');
  div.style.cssText = 'display:flex;flex-direction:column;align-items:center;justify-content:center;padding:120px 20px;text-align:center;gap:16px';
  div.innerHTML = `<div style="font-family:var(--serif);font-size:20px;font-weight:300;color:var(--text)">${msg}</div><div style="font-size:12px;color:var(--muted);letter-spacing:.5px">잠시만 기다려주세요</div>`;
  document.body.insertBefore(div, document.querySelector('footer'));
  return div;
}

function showError(id, msg) { const el = document.getElementById(id); el.textContent = msg; el.style.display = 'block'; }
function hideError(id)      { document.getElementById(id).style.display = 'none'; }

// ── DOMContentLoaded ──────────────────────────────────────────────────
window.addEventListener('DOMContentLoaded', async () => {
  detectDevMode();

  try {
    const cfg = await fetch('/api/orders/payment-config').then(r => r.json());
    PORTONE_STORE_ID    = cfg.storeId;
    PORTONE_CHANNEL_KEY = cfg.channelKey;
  } catch(e) { console.error('포트원 설정 로드 실패', e); }

  if (window.location.pathname === '/payment/success') {
    handlePaymentSuccess();
  } else if (window.location.pathname === '/payment/fail') {
    const params = new URLSearchParams(window.location.search);
    alert('결제가 취소되었습니다: ' + (params.get('message') || ''));
    window.location.href = '/';
  }

  const resumeId = new URLSearchParams(window.location.search).get('resume');
  if (resumeId) handleResume(resumeId);
});

// ── 이어하기 모달 ─────────────────────────────────────────────────────
let pendingExistingOrderData = null;

function showResumeModal(orderData) {
  pendingExistingOrderData = orderData;
  document.getElementById('resume-name').textContent     = orderData.existingCustomerName || '고객';
  document.getElementById('resume-order-id').textContent = '#' + orderData.orderId;
  document.getElementById('resume-modal').style.display  = 'flex';
}

function resumeExistingOrder() {
  document.getElementById('resume-modal').style.display = 'none';
  const data = pendingExistingOrderData;
  currentOrderId = data.orderId;
  presignedUrls  = data.presignedUrls || [];
  showUploadSection(data.orderId, IS_DEV);
}

async function closeResumeModal() {
  document.getElementById('resume-modal').style.display = 'none';
  const data = pendingExistingOrderData;
  pendingExistingOrderData = null;

  try { await fetch(`/api/orders/${data.orderId}/cancel`, { method: 'POST' }); }
  catch(e) { console.warn('기존 주문 취소 실패, 무시:', e); }

  const btn = document.getElementById('pay-btn');
  btn.disabled    = false;
  btn.textContent = '결제하고 사진 업로드하기';
  await startPayment();
}
</script>
</body>
</html>
